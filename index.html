<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Enregistrement des invit√©s</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-6">

  <div class="bg-white shadow-xl rounded-2xl p-8 max-w-lg w-full">
    <h1 class="text-2xl font-bold text-center mb-6 text-gray-800">Formulaire d‚Äôenregistrement des invit√©s</h1>
    
    <form id="guestForm" class="space-y-4">
      <input type="text" id="apartment" placeholder="Appartement" required class="w-full p-3 border rounded-xl focus:ring focus:ring-blue-300" value="A101">
      <input type="text" id="building" placeholder="B√¢timent" required class="w-full p-3 border rounded-xl focus:ring focus:ring-blue-300" value="B√¢timent B">
      <input type="date" id="arrivalDate" required class="w-full p-3 border rounded-xl focus:ring focus:ring-blue-300" value="2025-08-20">
      <input type="number" id="guestCount" placeholder="Nombre des invit√©s" required min="1" class="w-full p-3 border rounded-xl focus:ring focus:ring-blue-300" value="2">
      <input type="text" id="fullname" placeholder="Nom et Pr√©nom" required class="w-full p-3 border rounded-xl focus:ring focus:ring-blue-300" value="Jean Dupont">
      <input type="text" id="idNumber" placeholder="Passeport ou Carte Nationale" required class="w-full p-3 border rounded-xl focus:ring focus:ring-blue-300" value="AB1234567">
      
      <button type="submit" class="w-full bg-blue-600 text-white p-3 rounded-xl hover:bg-blue-700 transition">Enregistrer</button>
    </form>

    <div id="successMessage" class="mt-6 hidden text-green-600 font-semibold text-center">
      ‚úÖ Informations enregistr√©es avec succ√®s !
    </div>

    <div id="qrcodeContainer" class="mt-8 text-center hidden">
      <!-- Message au-dessus du QR code -->
      <p class="mb-4 text-center text-sm text-gray-700 font-semibold border p-3 rounded-lg bg-gray-50">
        ‚ö†Ô∏è Seules les voyageurs qui sont enregistr√©s dans la r√©servation et dans ce formulaire seront autoris√©s. 
        En cas de demande de ce code, merci de le pr√©senter aux agents de s√©curit√©.
      </p>
      
      <h2 class="text-lg font-semibold mb-4 text-gray-700">Votre QR Code</h2>
      <div id="qrcode" class="flex justify-center"></div>
      <button id="downloadBtn" class="mt-4 bg-green-600 text-white px-4 py-2 rounded-xl hover:bg-green-700 transition">T√©l√©charger le QR Code</button>
    </div>
  </div>

  <script>
    const qrCode = new QRCodeStyling({
      width: 250,
      height: 250,
      margin: 10,
      qrOptions: { typeNumber: 0, mode: "Byte", errorCorrectionLevel: "H" },
      dotsOptions: { color: "#1E40AF", type: "rounded" },
      backgroundOptions: { color: "#FFFFFF" },
      cornersSquareOptions: { type: "extra-rounded", color: "#1E40AF" },
      cornersDotOptions: { type: "dot", color: "#1E40AF" }
    });

    document.getElementById("guestForm").addEventListener("submit", function(e) {
      e.preventDefault();

      // V√©rification stricte de tous les champs
      const apartment = document.getElementById("apartment").value.trim();
      const building = document.getElementById("building").value.trim();
      const arrivalDate = document.getElementById("arrivalDate").value;
      const guestCount = document.getElementById("guestCount").value.trim();
      const fullname = document.getElementById("fullname").value.trim();
      const idNumber = document.getElementById("idNumber").value.trim();

      if (!apartment || !building || !arrivalDate || !guestCount || !fullname || !idNumber) {
        alert("Veuillez remplir tous les champs obligatoires !");
        return;
      }

      const message = `‚ö†Ô∏è Seules les voyageurs qui sont enregistr√©s dans la r√©servation et dans ce formulaire seront autoris√©s. 
Merci de pr√©senter ce QR Code aux agents de s√©curit√©.\n\n` +
        `üìå Appartement: ${apartment}\n` +
        `üè¢ B√¢timent: ${building}\n` +
        `üìÖ Date d'arriv√©e: ${arrivalDate}\n` +
        `üë• Nombre d'invit√©s: ${guestCount}\n` +
        `üôç Nom & Pr√©nom: ${fullname}\n` +
        `üÜî Passeport/Carte: ${idNumber}`;

      qrCode.update({ data: message });

      document.getElementById("qrcode").innerHTML = "";
      qrCode.append(document.getElementById("qrcode"));

      document.getElementById("successMessage").classList.remove("hidden");
      document.getElementById("qrcodeContainer").classList.remove("hidden");

      document.getElementById("guestForm").reset();
    });

    document.getElementById("downloadBtn").addEventListener("click", () => {
      qrCode.download({ name: "Guest_QR_Code", extension: "png" });
    });
  </script>

</body>
</html>