<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Interface utilisateur - Invités</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen p-6">

  <div class="max-w-4xl mx-auto bg-white shadow-xl rounded-2xl p-8">
    <h1 class="text-2xl font-bold mb-6 text-center text-gray-800">Liste des invités</h1>

    <!-- Tableau des invités -->
    <table class="w-full table-auto border border-gray-300 rounded-xl overflow-hidden">
      <thead class="bg-blue-600 text-white">
        <tr>
          <th class="px-4 py-2">Nom & Prénom</th>
          <th class="px-4 py-2">Appartement</th>
          <th class="px-4 py-2">Bâtiment</th>
          <th class="px-4 py-2">Date d'arrivée</th>
          <th class="px-4 py-2">Nombre d'invités</th>
          <th class="px-4 py-2">ID</th>
          <th class="px-4 py-2">Actions</th>
        </tr>
      </thead>
      <tbody id="guestTable" class="text-center">
        <!-- Les lignes seront insérées par JavaScript -->
      </tbody>
    </table>
  </div>

  <script>
    // Exemple d'invités provenant du "premier code"
    const guests = [
      {
        fullname: "Yeye (Yeye)",
        apartment: "6",
        building: "A6",
        arrivalDate: "2025-08-15",
        guestCount: 1,
        idNumber: "123456",
        sent: false
      },
      {
        fullname: "Jean Dupont",
        apartment: "A101",
        building: "Bâtiment B",
        arrivalDate: "2025-08-20",
        guestCount: 2,
        idNumber: "AB1234567",
        sent: false
      }
    ];

    function formatMessage(guest) {
      return `Salam :\nArrivée: ${guest.arrivalDate}\nAppartement: ${guest.apartment}\nImm: ${guest.building}\nNombre de personnes: ${guest.guestCount} personnes\nRéservation au nom de:\n${guest.fullname}\n\nAutres personnes:\n${guest.guestCount - 1}\n\nNB : Svp pas d'autres personnes autorisées seul Les personnes figurent dans la réservation.\n\nMerci\n------------------------------------------\nالسلام عليكم:\nالوصول: ${guest.arrivalDate}\nالشقة: ${guest.apartment}\nرقم العمارة: ${guest.building}\nعدد الأشخاص: ${guest.guestCount} أشخاص\nالحجز باسم: ${guest.fullname}\n\nأشخاص آخرون:\n${guest.guestCount - 1}\n\nملاحظة: الرجاء عدم السماح لأي أشخاص آخرين، فقط الأشخاص المذكورين في الحجز.\nشكرًا.`;
    }

    function populateTable() {
      const tbody = document.getElementById("guestTable");
      tbody.innerHTML = "";

      guests.forEach((guest, index) => {
        const tr = document.createElement("tr");
        tr.classList.add("border-b");

        tr.innerHTML = `
          <td class="px-4 py-2">${guest.fullname}</td>
          <td class="px-4 py-2">${guest.apartment}</td>
          <td class="px-4 py-2">${guest.building}</td>
          <td class="px-4 py-2">${guest.arrivalDate}</td>
          <td class="px-4 py-2">${guest.guestCount}</td>
          <td class="px-4 py-2">${guest.idNumber}</td>
          <td class="px-4 py-2">
            <button class="bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700 transition" 
              onclick="sendWhatsApp(${index}, this)">
              Envoyer WhatsApp
            </button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    function sendWhatsApp(index, btn) {
      const guest = guests[index];
      const message = encodeURIComponent(formatMessage(guest));
      const phoneNumber = ""; // Optionnel: numéro WhatsApp si vous voulez l'envoyer à un numéro spécifique
      const url = `https://wa.me/${phoneNumber}?text=${message}`;

      // Ouvre WhatsApp Web ou mobile
      window.open(url, "_blank");

      // Marque comme envoyé et souligne le bouton
      guest.sent = true;
      btn.classList.add("line-through");
      btn.textContent = "Envoyé";
    }

    populateTable();
  </script>

</body>
</html>